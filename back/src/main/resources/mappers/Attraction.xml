<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.ssafy.pathpartner.attraction.repository.AttractionDao">

	<resultMap id="AttractionInfoResultMap"
		type="AttractionInfoDto">
		<result property="contentId" column="content_id" />
		<result property="contentTypeId" column="content_type_id" />
		<result property="title" column="title" />
		<result property="addr1" column="addr1" />
		<result property="addr2" column="addr2" />
		<result property="zipcode" column="zipcode" />
		<result property="tel" column="tel" />
		<result property="firstImage" column="first_image" />
		<result property="firstImage2" column="first_image2" />
		<result property="readcount" column="readcount" />
		<result property="sidoCode" column="sido_code" />
		<result property="gugunCode" column="gugun_code" />
		<result property="latitude" column="latitude" />
		<result property="longitude" column="longitude" />
		<result property="mlevel" column="mlevel" />
		<result property="likes" column="likes" />
	</resultMap>

	<!-- Implementing attractionList(String sidoCode, String sigunguCode, String[] 
		contentType) -->
	<select id="selectAttraction" parameterType="AttractionInfoDto" resultMap="AttractionInfoResultMap">
		select * from attraction_info
		where content_id = #{contentId}
	</select>

	<select id="selectAllAttraction" resultMap="AttractionInfoResultMap">
		SELECT * FROM attraction_info
		WHERE 1=1
		<if test="sidoCode != null and sidoCode != ''">
			AND sido_code = #{sidoCode}
		</if>
		<if test="sigunguCode != null and sigunguCode != ''">
			AND gugun_code = #{sigunguCode}
		</if>
		<if test="contentType != null and contentType.length > 0">
			AND content_type_id IN
			<foreach item="typeId" collection="contentType" open="("
				separator="," close=")">
				#{typeId}
			</foreach>
		</if>
	</select>

	<!-- Implementing searchByTitle(String title, int sidoCode) -->
	<select id="searchByTitle" resultMap="AttractionInfoResultMap">
		SELECT * FROM attraction_info
		WHERE title LIKE CONCAT('%', #{title}, '%')
		AND sido_code = #{sidoCode}
	</select>

</mapper>